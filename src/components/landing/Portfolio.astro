---
// PortfolioCarousel.astro
---

<section class="border-b border-white/20 bg-accent-500">
  <div class="mx-auto max-w-7xl border-white/20 border-x px-8 py-8 gradient-grid overflow-hidden">
    <div class="mx-auto text-center">
      <h3 class="text-3xl font-display text-white uppercase">
        THE BRANDS YOU LOVE - THE ADS THEY LOVE
      </h3>
      <h3 class="text-xl font-display text-white uppercase mt-1">
        PORTFOLIO
      </h3>
    </div>
  </div>
</section>

<section class="border-b border-white/20 bg-accent-500">
  <div 
    class="mx-auto max-w-7xl border-white/20 border-x overflow-hidden"
    x-data="{ 
      splide: null,
      init() {
        this.splide = new Splide(this.$refs.splide, {
          perPage: 4.5,
          gap: '1rem',
          drag: true,
          snap: true,
          arrows: true,
          pagination: false,
          trimSpace: false,
          updateOnMove: true,
          flickPower: 100,
          dragMinThreshold: 10,
          speed: 400,
          touchAngle: 30,
          waitForTransition: true,
          breakpoints: {
            1024: {
              perPage: 3.5,
            },
            768: {
              perPage: 2.5,
            },
            640: {
              perPage: 1.5,
            }
          },
        });
        
        this.splide.on('mounted updated', () => {
          const slides = this.$refs.splide.querySelectorAll('.splide__slide');
          slides.forEach(slide => {
            slide.style.opacity = '1';
            slide.style.visibility = 'visible';
          });
        });
        
        this.splide.mount();
      }
    }"
  >
    <div
      class="splide"
      x-ref="splide"
      role="region"
      aria-label="Portfolio Carousel"
    >
      <div class="splide__track">
        <ul class="splide__list">
          {[1, 2, 3, 4, 5, 6, 7].map((num) => (
            <li class="splide__slide">
              <div class="relative aspect-video">
                <img
                  src={`/work/${num}.png`}
                  alt={`Portfolio work ${num}`}
                  class="w-full h-full object-cover object-center bg-white border-t border-black lg:border-r"
                  loading="lazy"
                />
              </div>
            </li>
          ))}
        </ul>
      </div>

      <div class="splide__arrows">
        <button
          class="splide__arrow splide__arrow--prev"
          type="button"
          aria-label="Previous"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="40" height="40" fill="currentColor">
            <path d="m15.5 0.932-4.3 4.38 14.5 14.6-14.5 14.5 4.3 4.4 14.6-14.6 4.4-4.3-4.4-4.4-14.6-14.6z"></path>
          </svg>
        </button>
        <button
          class="splide__arrow splide__arrow--next"
          type="button"
          aria-label="Next"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="40" height="40" fill="currentColor">
            <path d="m15.5 0.932-4.3 4.38 14.5 14.6-14.5 14.5 4.3 4.4 14.6-14.6 4.4-4.3-4.4-4.4-14.6-14.6z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <div class="mx-auto max-w-7xl border-white/20 border-x px-8 py-2 text-center">
    <p class="text-white text-lg font-display">1000+ more</p>
  </div>
</section>